<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lightweight: Sql Query</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Lightweight<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/dbe/md__2home_2runner_2work_2Lightweight_2Lightweight_2docs_2sqlquery.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Sql Query</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="sql-query"></a> Sql Query builder class is the starting point of building sql queries to execute.</p>
<h1><a class="anchor" id="create-or-modife-database-schema"></a>
Create or Modife database schema</h1>
<p>To create a database you need to use <code>Migration()</code> function provided by the <code><a class="el" href="../../d0/d78/classSqlQueryBuilder.html" title="API Entry point for building SQL queries.">SqlQueryBuilder</a></code> class, then use API defined in <code><a class="el" href="../../d3/d15/classSqlMigrationQueryBuilder.html" title="Query builder for building SQL migration queries.">SqlMigrationQueryBuilder</a></code> to construct sql query to migrate to another schema or create a databse with the given schema. Detailed documentation can be found on separate documentation pages for each of the classes in the hirerarchy, here we present overall usage of the library. Following options exist.</p>
<ul>
<li><code>CreateTable(tableName)</code> Following calls can be chained, for example <code>CreateTable("test").Column(first).Column(second)...</code> Available functions:<ul>
<li><code>PrimaryKey(std::string columnName, SqlColumnTypeDefinition columnType)</code><ul>
<li>create primary key colunm in the database, defined by name and type.</li>
</ul>
</li>
<li><code>PrimaryKeyWithAutoIncrement( std::string columnName, SqlColumnTypeDefinition columnType )</code><ul>
<li>create primary key column in the database with automatic indexing</li>
<li>Second parameter has a default value <code>SqlColumnTypeDefinitions::Bigint</code></li>
</ul>
</li>
<li><code>Column(std::string columnName, SqlColumnTypeDefinition columnType)</code>, <code>Column(SqlColumnDeclaration column)</code><ul>
<li>create a column specified by a name and type</li>
<li>for precise control on the column specification <code>SqlColumnDeclaration</code> can be used as an argument.</li>
</ul>
</li>
<li><code>RequiredColumn(std::string columnName, SqlColumnTypeDefinition columnType)</code><ul>
<li>create a non-nullable column defined by the name and type.</li>
</ul>
</li>
<li><code>Timestamps()</code><ul>
<li>adds the created_at and updated_at columns to the table.</li>
</ul>
</li>
<li><code>ForeignKey(std::string columnName, SqlColumnTypeDefinition columnType, SqlForeignKeyReferenceDefinition foreignKey)</code><ul>
<li>creates a new nullable foreign key column, non-nullable version is a <code>RequiredForeignKey</code> function.</li>
</ul>
</li>
<li>Additional function that change specification of the created columns with the following usage: <code>CreateTable("test").Column(first).UniqueIndex()</code>.<ul>
<li><code>Unique()</code> enables the UNIQUE constrain on the last declared column.</li>
<li><code>Index()</code> enables the INDEX constrain on the last declared column.</li>
<li><code>UniqueIndex()</code> enables the UNIQUE and INDEX constrain on the last declared column.</li>
</ul>
</li>
</ul>
</li>
<li><code>AlterTable(tableName)</code> Available functions:<ul>
<li><code>RenameTo(std::string_view newTableName)</code><ul>
<li>renames the table.</li>
</ul>
</li>
<li><code>RenameColumn(std::string_view oldColumnName, std::string_view newColumnName)</code><ul>
<li>renames a column.</li>
</ul>
</li>
<li><code>DropColumn(std::string_view columnName)</code><ul>
<li>drops a column from the table.</li>
</ul>
</li>
<li><code>AddIndex(std::string_view columnName)</code><ul>
<li>add an index to the table for the specified column.</li>
</ul>
</li>
<li><code>AddUniqueIndex(std::string_view columnName)</code><ul>
<li>add an index to the table for the specified column that is unique.</li>
</ul>
</li>
<li><code>DropIndex(std::string_view columnName)</code><ul>
<li>drop an index from the table for the specified column.</li>
</ul>
</li>
</ul>
</li>
<li><code>DropTable(tableName)</code><ul>
<li>Drops table with the given name, please make sure that no foreign key constrains restricts execution of this query for the given table.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="example"></a>
Example</h2>
<div class="fragment"><div class="line">CreateTable(&quot;Appointment&quot;).PrimaryKeyWithAutoIncrement(&quot;id&quot;, Guid{})</div>
<div class="line">                  .RequiredColumn(&quot;date&quot;, DateTime {} )</div>
<div class="line">                  .Column(&quot;comment&quot;, Varchar{80})</div>
<div class="line">                  .ForeignKey(&quot;physician_id&quot;, Guid{}, SqlForeignKeyReferenceDefinition {</div>
<div class="line">                                                          .tableName = &quot;Physician&quot;,</div>
<div class="line">                                                          .columnName = &quot;id&quot;,</div>
<div class="line">                                                      } )</div>
<div class="line">                  .ForeignKey(&quot;patient_id&quot;, Guid{}, SqlForeignKeyReferenceDefinition {</div>
<div class="line">                                                          .tableName = &quot;Patient&quot;,</div>
<div class="line">                                                          .columnName = &quot;id&quot;,</div>
<div class="line">                                                      } );</div>
</div><!-- fragment --><h1><a class="anchor" id="insert-elements"></a>
Insert elements</h1>
<p>To insert elements in the database first call <code>FrommTable(table)</code> function to specify which table to use, and then function <code>Insert()</code> to start construction of <code><a class="el" href="../../dd/dbd/classSqlInsertQueryBuilder.html" title="Query builder for building INSERT INTO ... queries.">SqlInsertQueryBuilder</a></code></p><ul>
<li><code>Set(std::string_view columnName, ColumnValue const&amp; value)</code><ul>
<li>Adds a single column to the INSERT query.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="select-elements"></a>
Select elements</h1>
<p>To select some elements from the Database you first need to specify which existing table you are going to use, for this use <code>FromTable(table)</code> function, it returns you an instance of a <code><a class="el" href="../../d0/d78/classSqlQueryBuilder.html" title="API Entry point for building SQL queries.">SqlQueryBuilder</a></code> and then use <code>Select()</code> function to continue constructing select query that described by <code><a class="el" href="../../d1/d91/classSqlSelectQueryBuilder.html" title="Query builder for building SELECT ... queries.">SqlSelectQueryBuilder</a></code> interface. Here we present a compressed list of functions that can be used to create complete selection query. <br  />
</p>
<ul>
<li>Select field<ul>
<li><code>Distinct()</code><ul>
<li>Adds a DISTINCT clause to the SELECT query.</li>
</ul>
</li>
<li><code><a class="el" href="../../df/d27/structField.html" title="Represents a single column in a table.">Field()</a></code><ul>
<li>Simple usage <code><a class="el" href="../../df/d27/structField.html" title="Represents a single column in a table.">Field</a>("field")</code></li>
<li>With table name specification as <code><a class="el" href="../../df/d27/structField.html" title="Represents a single column in a table.">Field</a>(<a class="el" href="../../d1/de4/structSqlQualifiedTableColumnName.html" title="SqlQualifiedTableColumnName represents a column name qualified with a table name.">SqlQualifiedTableColumnName</a> { "Table", "field" })</code></li>
</ul>
</li>
<li><code>Fields()</code><ul>
<li>Simple usage <code>Fields({"a", "b", "c"})</code></li>
<li>Fields from another table <code>Fields({"a", "b", "c"}, "Table_B")</code></li>
<li>Choose all fields of a structure that represents table <code><a class="el" href="../../df/d27/structField.html" title="Represents a single column in a table.">Field</a>&lt;TableType&gt;()</code>. Note: can pass more than one type</li>
</ul>
</li>
</ul>
</li>
<li>(optional) Order and Group<ul>
<li><code>OrderBy</code></li>
<li><code>GroupBy</code></li>
</ul>
</li>
<li>(optional) Additional option to build WHERE clause. See documentation for <code><a class="el" href="../../d2/dca/classSqlWhereClauseBuilder.html">SqlWhereClauseBuilder</a></code><ul>
<li><code>Where</code><ul>
<li><code>Where("a",1)</code> specify simple condition that is equivalent to the sql query <code>WHERE "a" = 1</code></li>
<li><code>Where(<a class="el" href="../../d1/de4/structSqlQualifiedTableColumnName.html" title="SqlQualifiedTableColumnName represents a column name qualified with a table name.">SqlQualifiedTableColumnName</a>{ .tableName = "Table_A", .columnName = "a"}, 1)</code> such call translated into <code>WHERE "Table_A".a" = 1&lt;/tt&gt;
  - &lt;tt&gt;Or()&lt;/tt&gt;, &lt;tt&gt;And()&lt;/tt&gt; and &lt;tt&gt;Not()&lt;/tt&gt; logical functions to apply to the next call
    + Example of usage &lt;tt&gt;Where("a",1).Or().Where("b",1)&lt;/tt&gt;
  -  &lt;tt&gt;Inner&lt;/tt&gt;|&lt;tt&gt;LeftOuter&lt;/tt&gt;|&lt;tt&gt;RightOuter&lt;/tt&gt;|&lt;tt&gt;FullOuter&lt;/tt&gt; + &lt;tt&gt;Join&lt;/tt&gt;
    + See documentation for &lt;tt&gt;SqlJoinConditionBuilder&lt;/tt&gt; for details 
* End
  - &lt;tt&gt;First()&lt;/tt&gt;
   + Specify number of elements to fetch, by default only one element will be fetched.
  - &lt;tt&gt;All()&lt;/tt&gt;


@subsection example-1 Example

@icode 
q.FromTable("Table_A")
                .Select()
                .Fields({ "foo"sv, "bar"sv }, "Table_A")
                .Fields({ "that_foo"sv, "that_id"sv }, "Table_B")
                .LeftOuterJoin("Table_B",
                               [](SqlJoinConditionBuilder q) {
                               return q.On("id", { .tableName = "Table_A", .columnName = "that_id" })
                                       .On("that_foo", { .tableName = "Table_A", .columnName = "foo" });
                               })
                .Where(SqlQualifiedTableColumnName { .tableName = "Table_A", .columnName = "foo" }, 42) .All()  </code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
